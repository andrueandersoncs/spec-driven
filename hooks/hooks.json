{
  "description": "Hooks for spec-driven development: validate specs, guide workflow, ensure verification before code generation",
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Check if this file write/edit modified a Dafny (.dfy) or TLA+ (.tla) specification file. If so, remind that verification should be run with /verify to check consistency. If the file was in specs/dafny/ or specs/tla/, note this for the user. If not a spec file, no action needed.",
            "timeout": 15
          }
        ]
      },
      {
        "matcher": "Write",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Check if this write created or updated files in src/ directory from code generation (/generate command or code-generator agent). If so, and if package.json does NOT exist, suggest running /scaffold to make the code runnable. If package.json exists but dependencies are missing (e.g., effect is used but not in package.json), suggest running 'bun install' or /scaffold to update.",
            "timeout": 15
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "If this write/edit is generating implementation code (in src/ directory) from specifications, verify that: 1) specs/assertions.json exists with confirmed assertions, 2) formal specs have been verified recently. If generating code without verified specs, warn that this may produce incorrect code. For non-generated code or spec files themselves, approve without warning.",
            "timeout": 20
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/check-test-prereqs.sh",
            "timeout": 5
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Before stopping, check the spec-driven development workflow state: 1) If specs were modified but not verified, remind user to run /verify. 2) If assertions were discussed but not captured in specs/assertions.json, remind to run /interview. 3) If code was generated but project not scaffolded (no package.json), remind to run /scaffold. 4) If everything looks complete, approve stopping with a summary of the project state.",
            "timeout": 20
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/load-spec-context.sh",
            "timeout": 10
          }
        ]
      }
    ]
  }
}
